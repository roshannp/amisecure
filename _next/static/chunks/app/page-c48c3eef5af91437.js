(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2150:(e,t,s)=>{Promise.resolve().then(s.bind(s,8256))},8256:(e,t,s)=>{"use strict";s.d(t,{HomeClient:()=>g});var r=s(5155),n=s(2115);let o="am_i_secure_scan_history";function l(){try{let e=localStorage.getItem(o);if(!e)return[];return JSON.parse(e)}catch(e){return[]}}function i(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function a(e){let{score:t,grade:s}=e,n=t>=80?"#166534":t>=60?"#92400e":"#b91c1c",o=2*Math.PI*45,l=t/100*o;return(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsxs)("svg",{className:"h-32 w-32 -rotate-90",viewBox:"0 0 100 100",children:[(0,r.jsx)("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"#e5e5e5",strokeWidth:"8"}),(0,r.jsx)("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:n,strokeWidth:"8",strokeLinecap:"round",strokeDasharray:o,strokeDashoffset:o-l,style:{transition:"stroke-dashoffset 0.8s ease"}})]}),(0,r.jsx)("div",{className:"text-4xl font-bold",style:{color:n},children:t}),(0,r.jsxs)("div",{className:"text-sm",style:{color:"#6e6e80"},children:["Security Grade: ",s]})]})}let d={critical:{borderColor:"#b91c1c",background:"rgba(185, 28, 28, 0.08)",color:"#b91c1c"},high:{borderColor:"#92400e",background:"rgba(146, 64, 14, 0.08)",color:"#92400e"},medium:{borderColor:"#854d0e",background:"rgba(133, 77, 14, 0.08)",color:"#854d0e"},low:{borderColor:"#4b5563",background:"rgba(75, 85, 99, 0.08)",color:"#4b5563"}};function c(e){let{actions:t}=e;return 0===t.length?(0,r.jsxs)("div",{className:"rounded-xl border p-6",style:{borderColor:"#e5e5e5",background:"rgba(22, 101, 52, 0.06)"},children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",style:{color:"#166534"},children:"No critical issues found"}),(0,r.jsx)("p",{className:"mt-2 text-sm",style:{color:"#6e6e80"},children:"Your attack surface looks good. Keep monitoring for changes and maintain security best practices."})]}):(0,r.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white p-6",style:{borderColor:"#e5e5e5"},children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold",style:{color:"#0d0d0d"},children:["Remediation Priority (",t.length,")"]}),(0,r.jsx)("p",{className:"mt-1 text-sm",style:{color:"#6e6e80"},children:"Sorted by impact + exploitability — fix in this order"}),(0,r.jsx)("ul",{className:"mt-4 space-y-3",children:t.map((e,t)=>(0,r.jsxs)("li",{className:"rounded-lg border p-4",style:d[e.severity],children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-2 flex-wrap",children:[(0,r.jsxs)("span",{className:"rounded px-2 py-0.5 text-xs font-bold",style:{background:"rgba(0,0,0,0.08)",color:"#0d0d0d"},children:["#",t+1," Priority"]}),(0,r.jsx)("span",{className:"rounded px-1.5 py-0.5 text-xs font-medium uppercase",children:e.severity}),void 0!==e.count&&(0,r.jsxs)("span",{className:"text-xs opacity-80",children:[e.count," found"]})]}),(0,r.jsx)("h3",{className:"mt-2 font-medium",children:e.title}),(0,r.jsx)("p",{className:"mt-1 text-sm opacity-90",children:e.description}),(0,r.jsxs)("p",{className:"mt-2 text-sm font-medium",children:["→ ",e.fix]})]},e.id))})]})}let m={hsts:{label:"Strict-Transport-Security",desc:"Forces HTTPS, prevents downgrade attacks"},csp:{label:"Content-Security-Policy",desc:"Mitigates XSS and injection"},xFrameOptions:{label:"X-Frame-Options",desc:"Prevents clickjacking"},xContentTypeOptions:{label:"X-Content-Type-Options",desc:"Prevents MIME sniffing"},referrerPolicy:{label:"Referrer-Policy",desc:"Controls referrer information"},permissionsPolicy:{label:"Permissions-Policy",desc:"Controls browser features"}};function h(e){let{host:t,headers:s}=e;return s?(0,r.jsxs)("div",{className:"rounded-lg border p-4",style:{borderColor:"#e5e5e5",background:"#f7f7f8"},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"font-mono text-sm font-medium",style:{color:"#0d0d0d"},children:t}),(0,r.jsxs)("span",{className:"rounded px-2 py-0.5 text-xs",style:{background:"#e5e5e5",color:"#0d0d0d"},children:[s.score,"/100"]})]}),(0,r.jsx)("div",{className:"mt-3 space-y-2",children:Object.keys(m).map(e=>{let t=s[e];if("object"==typeof t&&"present"in t){let{label:s,desc:n}=m[e];return(0,r.jsxs)("div",{className:"flex items-start gap-2 text-xs",children:[(0,r.jsx)("span",{className:"mt-0.5 h-2 w-2 shrink-0 rounded-full",style:{background:t.present?"#166534":"#b91c1c"}}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{style:{color:"#0d0d0d"},children:s}),(0,r.jsxs)("span",{style:{color:"#6e6e80"},children:[" — ",n]}),t.present&&t.value&&(0,r.jsx)("p",{className:"mt-0.5 truncate font-mono",style:{color:"#6e6e80"},children:t.value})]})]},e)}return null})})]}):(0,r.jsxs)("div",{className:"rounded-lg border p-4",style:{borderColor:"#e5e5e5",background:"#f7f7f8"},children:[(0,r.jsx)("h3",{className:"font-mono text-sm font-medium",style:{color:"#6e6e80"},children:t}),(0,r.jsx)("p",{className:"mt-2 text-sm",style:{color:"#6e6e80"},children:"Could not fetch headers (host may be unreachable or blocks requests)"})]})}function p(){return"https://secureasy-ehi73akrz-roshannps-projects.vercel.app"}function x(e){let{technologies:t}=e,[s,o]=(0,n.useState)([]),[l,i]=(0,n.useState)(!0),a=[...new Set(t)].filter(Boolean).slice(0,6),d=a.join(",");if((0,n.useEffect)(()=>{if(""===d){i(!1);return}i(!0),fetch("".concat(p(),"/api/cve?tech=").concat(encodeURIComponent(d))).then(e=>e.json()).then(e=>{o(e.results||[])}).catch(()=>o([])).finally(()=>i(!1))},[d]),0===a.length)return(0,r.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"#6e6e80"},children:(0,r.jsx)("p",{children:"No technologies detected. Run a scan to discover tech stack."})});if(l)return(0,r.jsxs)("div",{style:{padding:"2rem",textAlign:"center",color:"#6e6e80"},children:[(0,r.jsx)("p",{children:"Looking up CVEs for detected technologies…"}),(0,r.jsx)("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:a.join(", ")})]});if(!s.some(e=>e.cves.length>0))return(0,r.jsxs)("div",{style:{padding:"2rem",textAlign:"center",color:"#6e6e80"},children:[(0,r.jsx)("p",{children:"No recent CVEs found for detected technologies."}),(0,r.jsxs)("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:["Searched: ",a.join(", ")]})]});let c=e=>"CRITICAL"===e?"#b91c1c":"HIGH"===e?"#92400e":"MEDIUM"===e?"#854d0e":"#4b5563";return(0,r.jsx)("div",{style:{padding:"0.5rem 0"},children:s.map(e=>e.cves.length>0&&(0,r.jsxs)("div",{style:{marginBottom:"1.5rem",border:"1px solid #e5e5e5",borderRadius:"8px",overflow:"hidden"},children:[(0,r.jsx)("div",{style:{padding:"0.5rem 1rem",background:"#f7f7f8",fontWeight:600,color:"#0d0d0d"},children:e.technology}),(0,r.jsx)("ul",{style:{margin:0,padding:0,listStyle:"none"},children:e.cves.map(e=>(0,r.jsxs)("li",{style:{padding:"1rem",borderTop:"1px solid #e5e5e5"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem",flexWrap:"wrap"},children:[(0,r.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",style:{color:"#0d0d0d",fontWeight:600,textDecoration:"underline"},children:e.id}),(0,r.jsxs)("span",{style:{fontSize:"0.75rem",background:c(e.severity)+"30",color:c(e.severity),padding:"0.25rem 0.5rem",borderRadius:"4px",fontWeight:600},children:[e.severity," ",e.score>0&&"(".concat(e.score,")")]})]}),(0,r.jsx)("p",{style:{fontSize:"0.875rem",color:"#6e6e80",marginTop:"0.5rem",lineHeight:1.4},children:e.description}),e.published&&(0,r.jsxs)("p",{style:{fontSize:"0.75rem",color:"#6e6e80",marginTop:"0.25rem"},children:["Published: ",e.published]})]},e.id))})]},e.technology))})}function u(e){let{data:t}=e,{domain:s,subdomains:d=[],dns:m={a:[],aaaa:[],mx:[],txt:[],cname:[]},scanTime:p=0,rootSecurityHeaders:u}=t,{score:f,grade:g,actions:y}=function(e,t){let s;let r=Array.isArray(e)?e:[],n=100,o=[],l=r.filter(e=>e.hasCert&&!e.certValid),i=r.filter(e=>e.name.startsWith("dev")||e.name.startsWith("staging")||e.name.startsWith("test")),a=r.filter(e=>e.securityHeaders&&!e.securityHeaders.hsts.present),d=r.filter(e=>e.securityHeaders&&!e.securityHeaders.csp.present),c=r.filter(e=>e.securityHeaders&&!e.securityHeaders.xFrameOptions.present),m=r.filter(e=>!e.hasCert&&e.ips.length>0);l.length>0&&(n-=Math.min(30,10*l.length),o.push({id:"expired-certs",severity:"critical",title:"Expired SSL certificates",description:"".concat(l.length," subdomain(s) have expired certificates."),fix:"Renew SSL certificates immediately. Attackers can exploit expired certs for MITM attacks.",count:l.length,priorityScore:95+Math.min(l.length,4)})),i.length>0&&(n-=Math.min(20,5*i.length),o.push({id:"dev-exposed",severity:"high",title:"Development/staging subdomains exposed",description:"".concat(i.length," dev/staging subdomain(s) are publicly discoverable."),fix:"Restrict access with firewall rules, VPN, or remove from public DNS. Dev environments often have weaker security.",count:i.length,priorityScore:85+Math.min(i.length,5)}));let h=(t&&!t.hsts.present?1:0)+a.length;if(h>0){n-=Math.min(25,15+2*h);let e=t&&!t.hsts.present?1:0;o.push({id:"no-hsts",severity:"high",title:"Missing HSTS header",description:"Strict-Transport-Security header is not set on one or more hosts.",fix:"Add Strict-Transport-Security: max-age=31536000; includeSubDomains; preload to force HTTPS.",count:h,priorityScore:75+10*e+Math.min(h,5)})}let p=(t&&!t.csp.present?1:0)+d.length;p>0&&(n-=Math.min(15,5*p),o.push({id:"no-csp",severity:"medium",title:"Missing Content-Security-Policy",description:"CSP header helps prevent XSS and injection attacks.",fix:"Add a Content-Security-Policy header. Start with default-src 'self' and refine as needed.",count:p,priorityScore:55+Math.min(2*p,15)}));let x=(t&&!t.xFrameOptions.present?1:0)+c.length;return x>0&&(n-=Math.min(10,3*x),o.push({id:"no-xfo",severity:"medium",title:"Missing X-Frame-Options",description:"Clickjacking protection is not configured.",fix:"Add X-Frame-Options: DENY or SAMEORIGIN to prevent your site from being embedded in iframes.",count:x,priorityScore:45+Math.min(2*x,10)})),r.length>50&&(n-=10,o.push({id:"large-surface",severity:"low",title:"Large attack surface",description:"".concat(r.length," subdomains increases monitoring effort."),fix:"Audit and decommission unused subdomains. Consolidate services where possible.",priorityScore:20})),m.length>0&&m.some(e=>!e.name.startsWith("dev"))&&o.push({id:"no-https",severity:"high",title:"Subdomains without HTTPS",description:"Some subdomains may not support HTTPS.",fix:"Enable TLS for all public-facing subdomains.",count:m.length,priorityScore:80+Math.min(m.length,5)}),o.sort((e,t)=>t.priorityScore-e.priorityScore),s=(n=Math.max(0,Math.min(100,n)))>=90?"A":n>=80?"B":n>=70?"C":n>=50?"D":"F",{score:n,grade:s,actions:o}}(d,u),[b,j]=(0,n.useState)(null),v=(0,n.useMemo)(()=>d.flatMap(e=>e.technologies||[]),[d]);return(0,n.useEffect)(()=>{var e;let r=null!==(e=l().find(e=>e.domain===s))&&void 0!==e?e:null;r&&j(function(e,t){let s=new Set(e.subdomains),r=new Set(t);return{added:t.filter(e=>!s.has(e)),removed:e.subdomains.filter(e=>!r.has(e))}}(r,d.map(e=>e.name))),function(e){let t=l().filter(t=>t.domain!==e.domain),s=[e,...t].slice(0,10);localStorage.setItem(o,JSON.stringify(s))}({domain:s,scannedAt:t.scannedAt||new Date().toISOString(),subdomains:d.map(e=>e.name),subdomainCount:d.length})},[s,d,t.scannedAt]),(0,r.jsxs)("div",{className:"space-y-6",style:{background:"#f7f7f8",color:"#0d0d0d",borderRadius:"12px",padding:"1rem",border:"1px solid #e5e5e5"},children:[b&&(b.added.length>0||b.removed.length>0)&&(0,r.jsxs)("div",{className:"rounded-xl border border-gray-300 bg-white p-4",style:{borderColor:"#e5e5e5"},children:[(0,r.jsx)("h3",{className:"font-medium",style:{color:"#0d0d0d"},children:"Changes since last scan"}),b.added.length>0&&(0,r.jsxs)("p",{className:"mt-1 text-sm",style:{color:"#6e6e80"},children:[(0,r.jsxs)("span",{style:{color:"#166534"},children:["+",b.added.length," new"]}),": ",b.added.slice(0,5).join(", "),b.added.length>5&&" …"]}),b.removed.length>0&&(0,r.jsxs)("p",{className:"mt-1 text-sm",style:{color:"#6e6e80"},children:[(0,r.jsxs)("span",{style:{color:"#b91c1c"},children:["−",b.removed.length," removed"]}),": ",b.removed.slice(0,5).join(", "),b.removed.length>5&&" …"]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[(0,r.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white p-6",style:{borderColor:"#e5e5e5"},children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",style:{color:"#0d0d0d"},children:"Security Score"}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(a,{score:f,grade:g})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("button",{onClick:()=>{let e=new Blob([function(e,t,s,r){let n=new Date(e.scannedAt||Date.now()).toLocaleString(),o=e.subdomains.map(e=>{var t;return"\n    <tr>\n      <td>".concat(i(e.name),"</td>\n      <td>").concat(e.ips.slice(0,3).join(", ")||"—","</td>\n      <td>").concat(e.certValid?"✓":"✗","</td>\n      <td>").concat((null===(t=e.technologies)||void 0===t?void 0:t.slice(0,3).join(", "))||"—","</td>\n      <td>").concat(e.securityHeaders?"".concat(e.securityHeaders.score,"/100"):"—","</td>\n    </tr>")}).join(""),l=t.length>0?t.map((e,t)=>"\n    <li><strong>#".concat(t+1," Priority (").concat(e.severity.toUpperCase(),")</strong> — ").concat(i(e.title)," — ").concat(i(e.fix),"</li>")).join(""):"<li>No critical issues found.</li>";return'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="utf-8">\n  <title>AM I SECURE Report — '.concat(i(e.domain),'</title>\n  <style>\n    body { font-family: ui-sans-serif, system-ui, sans-serif; max-width: 800px; margin: 0 auto; padding: 2rem; background: #ffffff; color: #0d0d0d; }\n    h1 { color: #0d0d0d; }\n    h2 { color: #6e6e80; margin-top: 2rem; }\n    table { width: 100%; border-collapse: collapse; margin: 1rem 0; }\n    th, td { border: 1px solid #e5e5e5; padding: 0.5rem 1rem; text-align: left; }\n    th { background: #f7f7f8; }\n    .score { font-size: 2rem; font-weight: bold; color: #0d0d0d; }\n    .grade { font-size: 1.5rem; color: #6e6e80; }\n    ul { line-height: 1.6; }\n    .meta { color: #6e6e80; font-size: 0.9rem; }\n  </style>\n</head>\n<body>\n  <h1>AM I SECURE — Attack Surface Report</h1>\n  <p class="meta">Generated ').concat(n," | Domain: ").concat(i(e.domain),'</p>\n\n  <h2>Security Score</h2>\n  <p><span class="score">').concat(s,'/100</span> <span class="grade">(Grade ').concat(r,")</span></p>\n\n  <h2>Summary</h2>\n  <ul>\n    <li>Subdomains found: ").concat(e.subdomains.length,"</li>\n    <li>Scan duration: ").concat((e.scanTime/1e3).toFixed(1),"s</li>\n  </ul>\n\n  <h2>Recommended Actions</h2>\n  <ul>").concat(l,"</ul>\n\n  <h2>DNS Records (").concat(e.domain,")</h2>\n  <ul>\n    ").concat(e.dns.a.length?"<li>A: ".concat(e.dns.a.join(", "),"</li>"):"","\n    ").concat(e.dns.mx.length?"<li>MX: ".concat(e.dns.mx.slice(0,3).join(", "),"</li>"):"","\n  </ul>\n\n  <h2>Subdomains</h2>\n  <table>\n    <thead><tr><th>Subdomain</th><th>IPs</th><th>Valid Cert</th><th>Technologies</th><th>Header Score</th></tr></thead>\n    <tbody>").concat(o,'</tbody>\n  </table>\n\n  <p class="meta" style="margin-top: 3rem;">Report by AM I SECURE</p>\n</body>\n</html>')}(t,y,f,g)],{type:"text/html"}),r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download="am-i-secure-report-".concat(s,"-").concat(new Date().toISOString().slice(0,10),".html"),n.click(),URL.revokeObjectURL(r)},className:"rounded-lg border px-4 py-2 text-sm font-medium transition hover:opacity-90",style:{background:"#0d0d0d",color:"#ffffff",borderColor:"#0d0d0d"},children:"Download Report (HTML)"}),(0,r.jsx)("p",{className:"text-xs",style:{color:"#6e6e80"},children:"Open in browser, then Print → Save as PDF"})]})]}),(0,r.jsx)(c,{actions:y}),(0,r.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white p-6",style:{borderColor:"#e5e5e5"},children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",style:{color:"#0d0d0d"},children:"Scan Summary"}),(0,r.jsxs)("div",{className:"mt-4 grid gap-4 sm:grid-cols-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm",style:{color:"#6e6e80"},children:"Subdomains"}),(0,r.jsx)("p",{className:"text-2xl font-bold",style:{color:"#0d0d0d"},children:d.length})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm",style:{color:"#6e6e80"},children:"Risk score"}),(0,r.jsxs)("p",{className:"text-2xl font-bold",style:{color:f>=80?"#166534":f>=60?"#92400e":"#b91c1c"},children:[f,"/100"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm",style:{color:"#6e6e80"},children:"Issues found"}),(0,r.jsx)("p",{className:"text-2xl font-bold",style:{color:"#0d0d0d"},children:y.length})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm",style:{color:"#6e6e80"},children:"Scan time"}),(0,r.jsxs)("p",{className:"text-2xl font-bold",style:{color:"#0d0d0d"},children:[(p/1e3).toFixed(1),"s"]})]})]})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white p-6",style:{borderColor:"#e5e5e5"},children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",style:{color:"#0d0d0d"},children:"Security Headers"}),(0,r.jsx)("p",{className:"mt-1 text-sm",style:{color:"#6e6e80"},children:"HTTP security headers for main domain and key subdomains"}),(0,r.jsxs)("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[(0,r.jsx)(h,{host:s,headers:u}),d.filter(e=>e.securityHeaders).slice(0,3).map(e=>(0,r.jsx)(h,{host:e.name,headers:e.securityHeaders},e.name))]})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white p-6",style:{borderColor:"#e5e5e5"},children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold",style:{color:"#0d0d0d"},children:["DNS records for ",s]}),(0,r.jsxs)("div",{className:"mt-4 space-y-2 font-mono text-sm",children:[m.a.length>0&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{style:{color:"#6e6e80"},children:"A:"})," ",(0,r.jsx)("span",{style:{color:"#0d0d0d"},children:m.a.join(", ")})]}),m.aaaa.length>0&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{style:{color:"#6e6e80"},children:"AAAA:"})," ",(0,r.jsx)("span",{style:{color:"#0d0d0d"},children:m.aaaa.join(", ")})]}),m.mx.length>0&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{style:{color:"#6e6e80"},children:"MX:"})," ",(0,r.jsx)("span",{style:{color:"#0d0d0d"},children:m.mx.join(", ")})]}),m.txt.length>0&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{style:{color:"#6e6e80"},children:"TXT:"})," ",(0,r.jsxs)("span",{className:"block max-w-full truncate",style:{color:"#0d0d0d"},children:[m.txt.slice(0,2).join(" | "),m.txt.length>2&&" (+".concat(m.txt.length-2," more)")]})]}),m.cname.length>0&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{style:{color:"#6e6e80"},children:"CNAME:"})," ",(0,r.jsx)("span",{style:{color:"#0d0d0d"},children:m.cname.join(", ")})]}),0===m.a.length&&0===m.aaaa.length&&0===m.mx.length&&0===m.txt.length&&0===m.cname.length&&(0,r.jsx)("p",{style:{color:"#6e6e80"},children:"No DNS records found"})]})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white p-6",style:{borderColor:"#e5e5e5"},children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold",style:{color:"#0d0d0d"},children:["Discovered Subdomains (",d.length,")"]}),(0,r.jsx)("p",{className:"mt-1 text-sm",style:{color:"#6e6e80"},children:"From Certificate Transparency logs — scroll for full list"}),(0,r.jsx)("ul",{className:"mt-4 space-y-2 max-h-[70vh] overflow-y-auto",children:d.map(e=>{var t;return(0,r.jsxs)("li",{className:"flex flex-wrap items-center justify-between gap-2 rounded-lg border px-4 py-3 font-mono text-sm",style:{borderColor:"#e5e5e5",background:"#f7f7f8"},children:[(0,r.jsx)("span",{style:{color:"#0d0d0d"},children:e.name}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[null===(t=e.technologies)||void 0===t?void 0:t.map(e=>(0,r.jsx)("span",{className:"rounded px-2 py-0.5 text-xs",style:{background:"#e5e5e5",color:"#0d0d0d"},children:e},e)),e.ips.length>0&&(0,r.jsxs)("span",{style:{color:"#6e6e80"},children:[e.ips.slice(0,2).join(", "),e.ips.length>2&&"…"]}),!e.certValid&&e.hasCert&&(0,r.jsx)("span",{className:"rounded px-1.5 py-0.5 text-xs",style:{background:"rgba(185, 28, 28, 0.15)",color:"#b91c1c"},children:"Expired"}),(e.name.startsWith("dev")||e.name.startsWith("staging"))&&(0,r.jsx)("span",{className:"rounded px-1.5 py-0.5 text-xs",style:{background:"rgba(146, 64, 14, 0.15)",color:"#92400e"},children:"Dev"}),e.securityHeaders&&(0,r.jsxs)("span",{className:"rounded px-1.5 py-0.5 text-xs",style:{background:"#e5e5e5",color:"#6e6e80"},children:[e.securityHeaders.score,"%"]})]})]},e.name)})})]}),(0,r.jsxs)("details",{className:"rounded-xl border border-gray-200 overflow-hidden",style:{borderColor:"#e5e5e5",background:"#ffffff"},children:[(0,r.jsx)("summary",{className:"cursor-pointer p-4 font-medium hover:bg-gray-100",style:{color:"#0d0d0d"},children:"CVE Lookup (by detected technologies)"}),(0,r.jsx)("div",{className:"border-t px-4 pb-4 pt-2",style:{borderColor:"#e5e5e5"},children:(0,r.jsx)(x,{technologies:v})})]})]})}let f="scan-results";function g(){let[e,t]=(0,n.useState)(""),[s,o]=(0,n.useState)(!1),[i,a]=(0,n.useState)(0),[d,c]=(0,n.useState)(null),[m,h]=(0,n.useState)(null),[x,g]=(0,n.useState)([]),y=(0,n.useRef)(0),b=(0,n.useRef)(null);(0,n.useEffect)(()=>{g(l())},[d]),(0,n.useEffect)(()=>(s?(a(0),y.current=Date.now(),b.current=setInterval(()=>{a(Math.min(95,95*(1-Math.exp(-((Date.now()-y.current)/1e3)/12))))},100)):(b.current&&(clearInterval(b.current),b.current=null),a(0)),()=>{b.current&&clearInterval(b.current)}),[s]);let j=async t=>{if(t.preventDefault(),e.trim()){o(!0),h(null),c(null);try{let t=e.trim().replace(/^https?:\/\//,"").split("/")[0],s=await fetch("".concat(p(),"/api/scan?domain=").concat(encodeURIComponent(t))),r=await s.json();if(!s.ok)throw Error(r.error||"Scan failed");c(r),setTimeout(()=>{var e;null===(e=document.getElementById(f))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start"})},300)}catch(e){h(e instanceof Error?e.message:"Something went wrong")}finally{b.current&&(clearInterval(b.current),b.current=null),a(100),setTimeout(()=>o(!1),250)}}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("form",{onSubmit:j,style:{marginBottom:"1.5rem"},children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[(0,r.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter domain (e.g. example.com)",disabled:s,style:{flex:1,padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid #e5e5e5",background:"#ffffff",color:"#0d0d0d",fontSize:"1rem"}}),(0,r.jsx)("button",{type:"submit",disabled:s,style:{padding:"0.75rem 1.5rem",borderRadius:"8px",background:"#000000",color:"#ffffff",fontWeight:500,border:"none",cursor:s?"not-allowed":"pointer",opacity:s?.6:1},children:s?"Scanning...":"Scan"})]})}),s&&(0,r.jsxs)("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"#f7f7f8",borderRadius:"12px",border:"1px solid #e5e5e5"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,r.jsxs)("span",{style:{fontSize:"1rem",fontWeight:600,color:"#0d0d0d"},children:[Math.round(i),"%"]}),(0,r.jsx)("span",{style:{fontSize:"0.8rem",color:"#6e6e80"},children:"Scanning..."})]}),(0,r.jsx)("div",{style:{height:"12px",background:"#e5e5e5",borderRadius:"6px",overflow:"hidden"},children:(0,r.jsx)("div",{style:{height:"100%",width:"".concat(i,"%"),background:"#0d0d0d",borderRadius:"6px",transition:"width 0.15s ease-out"}})}),(0,r.jsx)("p",{style:{fontSize:"0.75rem",color:"#6e6e80",margin:"0.5rem 0 0 0"},children:"Discovering subdomains → checking DNS → security headers..."}),(0,r.jsx)("p",{style:{fontSize:"0.7rem",color:"#6e6e80",margin:"0.25rem 0 0 0",opacity:.8},children:"Large domains may take 30+ seconds. If nothing appears, check the browser console for errors."})]}),x.length>0&&!d&&!s&&(0,r.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,r.jsx)("p",{style:{fontSize:"0.875rem",color:"#6e6e80",marginBottom:"0.5rem"},children:"Recent scans"}),(0,r.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:x.slice(0,5).map(e=>(0,r.jsx)("button",{onClick:()=>t(e.domain),style:{padding:"0.375rem 0.75rem",borderRadius:"8px",border:"1px solid #e5e5e5",background:"#f7f7f8",color:"#0d0d0d",cursor:"pointer",fontSize:"0.875rem"},children:e.domain},"".concat(e.domain,"-").concat(e.scannedAt)))})]}),m&&(0,r.jsx)("div",{style:{padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid #b91c1c",background:"rgba(185, 28, 28, 0.08)",color:"#b91c1c",marginBottom:"1.5rem"},children:m}),d&&(0,r.jsxs)("div",{id:f,style:{marginTop:"1.5rem"},children:[(0,r.jsxs)("h2",{style:{fontSize:"1.25rem",fontWeight:600,color:"#0d0d0d",marginBottom:"1rem"},children:["Results for ",d.domain]}),(0,r.jsx)(u,{data:d})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(2150)),_N_E=e.O()}]);